---
import Picture from 'astro/components/Picture.astro';
import testImage from '@assets/images/test.jpg';
import type { CollectionEntry } from 'astro:content';
import DateLabel from '@/components/interface/DateLabel.astro';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;

const hasCover = post.data.cover;
---

<style>
  .archive-post-card-wrapper {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 1rem;

    background-color: var(--clr-crust);

    border-radius: var(--radius-surface);
    outline: 1px solid var(--clr-surface-0);

    height: 8rem;

    overflow: hidden;
  }

  .picture-wrapper {
    position: relative;

    display: flex;
    align-items: center;
    justify-content: center;

    aspect-ratio: 5 / 3;

    overflow: hidden;

    max-height: 100%;
  }

  .archive-post-img {
    position: absolute;
    left: 0;
    top: 0;

    width: 100%;
    height: 100%;

    object-fit: cover;

    cursor: pointer;

    transition-property: scale;
    transition-duration: 0.25s;
    transition-timing-function: ease-in-out;
  }

  .archive-post-img:hover {
    scale: 1.04;
  }

  .content-wrapper {
    display: flex;
    flex-direction: column;
    align-items: start;
    justify-content: center;
    gap: 0.4rem;

    padding: 1rem;
    /* padding-left: 0; */
  }

  .content-wrapper-has-cover {
    padding-left: 0;
  }

  a.post-title-link {
    text-decoration: none;

    transition-property: color;
    transition-duration: 0.15s;
    transition-timing-function: ease-out;
  }

  a.post-title-link:hover {
    color: var(--clr-primary);
  }

  .post-title {
    font-size: 1.25rem;

    margin: 0;
  }

  .date-wrapper {
    margin-bottom: 0.2rem;
  }
</style>

<div class='archive-post-card-wrapper'>
  {
    hasCover && (
      <div class='picture-wrapper'>
        <a href={`/blog/${post.slug}`}>
          <Picture
            width={400}
            height={400}
            src={post.data.cover}
            alt={post.data.cover_alt ? post.data.cover_alt : ''}
            formats={['avif', 'webp', 'png']}
            decoding={'async'}
            loading={'lazy'}
            class='archive-post-img'
          />
        </a>
      </div>
    )
  }
  <div class={`content-wrapper ${hasCover ? 'content-wrapper-has-cover' : ''}`}>
    <div class='date-wrapper'>
      <DateLabel date={post.data.date_published} />
    </div>
    <a
      class='post-title-link'
      href={`/blog/${post.slug}`}>
      <h5 class='post-title'>{post.data.title}</h5>
    </a>
    <p>{post.data.description}</p>
  </div>
</div>
